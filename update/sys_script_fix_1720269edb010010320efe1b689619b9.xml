<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_fix">
    <sys_script_fix action="INSERT_OR_UPDATE">
        <active>true</active>
        <before>false</before>
        <description>Transferring employees to the user table and populating the User Reference field with their information.</description>
        <flush_cache>false</flush_cache>
        <name>TransferEmployees</name>
        <record_for_rollback>false</record_for_rollback>
        <run_once>true</run_once>
        <script><![CDATA[// adding the current Employee to the User table
addEmployeeToUserTable();

// Populating the 'User account' on the Employee table from the user table.
populateReference();



function addEmployeeToUserTable(){
	
	var emp = new GlideRecord('x_422182_devin_s_t_devins_employees');
	emp.query();
	
	while(emp.next()){
		
		var user = new GlideRecord('sys_user');
		user.query();
		
		user.initialize();
		user.user_name = emp.primary_e_mail;
		user.email = emp.primary_e_mail;
		user.first_name = emp.first_name;
		user.last_name = emp.last_name;
		user.phone = emp.phone_number;
		user.insert();
	}
}

function populateReference(){
	
	var emp1 = new GlideRecord('x_422182_devin_s_t_devins_employees');
	emp1.query();
	
	while(emp1.next()){
	
		var user1 = new GlideRecord('sys_user');
		user1.addQuery('email', emp1.primary_e_mail);
		user1.query();
		
		if(user1.next()){
			
			emp1.user_account = user1.sys_id;
			emp1.update();
		}
	}
}]]></script>
        <sys_class_name>sys_script_fix</sys_class_name>
        <sys_created_by>devin.roberts@itechag.com</sys_created_by>
        <sys_created_on>2019-11-13 15:43:44</sys_created_on>
        <sys_id>1720269edb010010320efe1b689619b9</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>TransferEmployees</sys_name>
        <sys_package display_value="NeedIt" source="x_58872_needit">6ead8e780f603200cd674f8ce1050ed1</sys_package>
        <sys_policy/>
        <sys_scope display_value="NeedIt">6ead8e780f603200cd674f8ce1050ed1</sys_scope>
        <sys_update_name>sys_script_fix_1720269edb010010320efe1b689619b9</sys_update_name>
        <sys_updated_by>devin.roberts@itechag.com</sys_updated_by>
        <sys_updated_on>2019-11-13 15:43:51</sys_updated_on>
        <unloadable>false</unloadable>
    </sys_script_fix>
</record_update>
